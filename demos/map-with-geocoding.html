<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Map Demo with Geocoding and Reversed Geocoding - SetMap jQuery Plugin</title>
		<link href="../css/main.css" rel="stylesheet"/>
	</head>
	<body>
		<form method="POST" action="">
			<div>
				<div>
					<label for="location">Location</label>
					<p class="desc"><small>Drag marker to fix location or fill in the address fields</small></p>
				</div>
				<div>
					<input type="text" id="location" name="location" tabindex="3" />
					<button class="actButton" id="searchLoc" type="button">Search</button>
					<div id="form-map" class="css-map"></div>
					<p>
						<input type="text" name="lat" id="lat" value="-34.397" />
						<input type="text" name="lng" id="lng" value="150.644" />
					</p>
				</div>
			</div>
		</form>
		<!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if offline -->
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
		<script>window.jQuery || document.write('<script src="../js/libs/jquery-1.6.4.min.js"><\/script>')</script>
		<script src="http://maps.googleapis.com/maps/api/js?language=en&sensor=false&region=US"></script>
		<script defer src="../js/setmap.min.js"></script>
		<script>
			$(function () {
				$('#form-map').setmap({
					drop: function ( latitude, longitude, fullAddress ) {
						$('#lat').val(latitude);
						$('#lng').val(longitude);
						$('#location').val(fullAddress);
					},
					marker: {
						position: {
							latitude: 40.733,
							longitude: -74.007
						},
						title: 'New York! New Yoooork!'
					}
				});
				
				$('#searchLoc').bind('click', function () {
					$('#form-map').setmap('setAddress', $('#location').val(), function ( latitude, longitude, fullAddress ) {
						$('#lat').val(latitude);
						$('#lng').val(longitude);
						$('#location').val(fullAddress);
					});
				});
	
				$('#location').bind('keyup', function ( e ) {
					if( e.keyCode === 13 ) {
						$('#searchLoc').trigger('click');
					}
				});
				
			});
		</script>
	</body>
</html>
